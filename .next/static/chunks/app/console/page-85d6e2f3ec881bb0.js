(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[520],{2693:(e,a,t)=>{Promise.resolve().then(t.bind(t,3496))},3496:(e,a,t)=>{"use strict";t.r(a),t.d(a,{default:()=>N});var s=t(5155),r=t(2115),l=t(2596),i=t(9688);function n(){for(var e=arguments.length,a=Array(e),t=0;t<e;t++)a[t]=arguments[t];return(0,i.QP)((0,l.$)(a))}function d(e){let{className:a,...t}=e;return(0,s.jsx)("div",{"data-slot":"card",className:n("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",a),...t})}function c(e){let{className:a,...t}=e;return(0,s.jsx)("div",{"data-slot":"card-content",className:n("px-6",a),...t})}var o=t(4624);let x=(0,t(2085).F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",{variants:{variant:{default:"bg-primary text-primary-foreground shadow-xs hover:bg-primary/90",destructive:"bg-destructive text-white shadow-xs hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50",secondary:"bg-secondary text-secondary-foreground shadow-xs hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2 has-[>svg]:px-3",sm:"h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5",lg:"h-10 rounded-md px-6 has-[>svg]:px-4",icon:"size-9"}},defaultVariants:{variant:"default",size:"default"}});function m(e){let{className:a,variant:t,size:r,asChild:l=!1,...i}=e,d=l?o.DX:"button";return(0,s.jsx)(d,{"data-slot":"button",className:n(x({variant:t,size:r,className:a})),...i})}function u(e){let{className:a,type:t,...r}=e;return(0,s.jsx)("input",{type:t,"data-slot":"input",className:n("file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input flex h-9 w-full min-w-0 rounded-md border bg-transparent px-3 py-1 text-base shadow-xs transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm","focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]","aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",a),...r})}var h=t(4416),g=t(7213),f=t(9869),p=t(4355),b=t(1154),v=t(5339),j=t(1284),y=t(6766);function N(){let[e,a]=(0,r.useState)(null),[t,l]=(0,r.useState)(null),[i,n]=(0,r.useState)(null),[o,x]=(0,r.useState)(!1),[N,w]=(0,r.useState)(!1),k=(0,r.useRef)(null),C=(0,r.useRef)(null),z=(0,r.useRef)(null),A=(0,r.useRef)(null);(0,r.useEffect)(()=>()=>{A.current&&A.current.getTracks().forEach(e=>e.stop())},[]);let P=async()=>{try{if(!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia){n("Camera not supported on this device or browser.");return}let e=await navigator.mediaDevices.getUserMedia({video:{facingMode:"environment",width:{ideal:1280},height:{ideal:720}}});A.current=e,C.current&&(C.current.srcObject=e),w(!0),n(null)}catch(e){console.error("Error accessing camera:",e),n("Failed to access camera. Please check permissions.")}},E=()=>{A.current&&(A.current.getTracks().forEach(e=>e.stop()),A.current=null),C.current&&(C.current.srcObject=null),w(!1)},F=async()=>{if(e){x(!0),n(null);try{if(!e.startsWith("data:image/")){n("Invalid image format"),x(!1);return}let a=await fetch("/api/analyze-food",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({image:e})});if(!a.ok){let e=await a.json();throw Error(e.error||"Failed to analyze image")}let t=await a.json();t.error?(n(t.error),l(null)):t.analysis?l(_(t.analysis)):n("Unexpected response format from the server")}catch(e){console.error("Error analyzing image:",e),n(e instanceof Error?e.message:"Error analyzing image. Please try again.")}finally{x(!1)}}},_=e=>e.replace(/\*\*(.*?)\*\*/g,"<strong>$1</strong>").replace(/\n\n/g,"<br/><br/>").replace(/\n([0-9]+\))/g,"<br/><br/>$1");return(0,s.jsx)(s.Fragment,{children:(0,s.jsx)("main",{className:"min-h-screen bg-gray-50 p-4 sm:p-6 md:p-8","aria-labelledby":"page-heading",children:(0,s.jsxs)("div",{className:"max-w-5xl mx-auto rounded-3xl bg-white p-4 sm:p-6 md:p-10 shadow-sm",children:[(0,s.jsx)("div",{className:"mb-6 sm:mb-8 lg:mb-16",children:(0,s.jsxs)("div",{className:"flex flex-col lg:flex-row lg:items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)("p",{className:"text-xl font-medium mb-2",children:"Nu."}),(0,s.jsx)("h1",{id:"page-heading",className:"text-3xl sm:text-4xl lg:text-6xl font-bold mb-4 sm:mb-6",children:"Know what's in it."}),(0,s.jsxs)("div",{className:"flex flex-wrap gap-2 md:gap-4 mt-6 lg:mt-12",children:[(0,s.jsx)(m,{variant:"outline",className:"rounded-full border-blue-600 text-blue-600 hover:bg-blue-50 text-sm sm:text-base",children:"Explore Calories"}),(0,s.jsx)(m,{variant:"outline",className:"rounded-full border-blue-600 text-blue-600 hover:bg-blue-50 text-sm sm:text-base",children:"Nutrients"}),(0,s.jsx)(m,{variant:"outline",className:"rounded-full border-blue-600 text-blue-600 hover:bg-blue-50 text-sm sm:text-base",children:"History"})]})]}),(0,s.jsx)("div",{className:"relative mt-6 lg:mt-0",children:(0,s.jsxs)("div",{className:"flex flex-col items-center lg:items-end",children:[(0,s.jsx)("div",{className:"relative h-48 w-48 sm:h-60 sm:w-60 lg:h-80 lg:w-80",children:(0,s.jsx)(y.default,{src:"/bakery-image.png",alt:"Croissant pastry",fill:!0,sizes:"(max-width: 640px) 192px, (max-width: 768px) 240px, (max-width: 1024px) 288px, 320px",style:{objectFit:"contain"},priority:!0})}),(0,s.jsxs)("div",{className:"flex flex-wrap justify-center gap-2 mt-4",children:[(0,s.jsxs)("div",{className:"flex flex-col items-center",children:[(0,s.jsx)("div",{className:"bg-white border border-gray-200 rounded-full px-4 sm:px-6 py-1 sm:py-2 text-center",children:(0,s.jsx)("span",{className:"text-xl sm:text-2xl font-bold",children:"320"})}),(0,s.jsx)("span",{className:"text-xs sm:text-sm mt-1",children:"Calories"})]}),(0,s.jsxs)("div",{className:"flex flex-col items-center",children:[(0,s.jsx)("div",{className:"bg-white border border-gray-200 rounded-full px-4 sm:px-6 py-1 sm:py-2 text-center",children:(0,s.jsx)("span",{className:"text-xl sm:text-2xl font-bold",children:"17g"})}),(0,s.jsx)("span",{className:"text-xs sm:text-sm mt-1",children:"Fat"})]}),(0,s.jsxs)("div",{className:"flex flex-col items-center",children:[(0,s.jsx)("div",{className:"bg-white border border-gray-200 rounded-full px-4 sm:px-6 py-1 sm:py-2 text-center",children:(0,s.jsx)("span",{className:"text-xl sm:text-2xl font-bold",children:"38g"})}),(0,s.jsx)("span",{className:"text-xs sm:text-sm mt-1",children:"Carbs"})]}),(0,s.jsxs)("div",{className:"flex flex-col items-center",children:[(0,s.jsx)("div",{className:"bg-white border border-gray-200 rounded-full px-4 sm:px-6 py-1 sm:py-2 text-center",children:(0,s.jsx)("span",{className:"text-xl sm:text-2xl font-bold",children:"6g"})}),(0,s.jsx)("span",{className:"text-xs sm:text-sm mt-1",children:"Protein"})]})]})]})})]})}),(0,s.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 md:gap-8",children:[(0,s.jsxs)("section",{"aria-labelledby":"upload-heading",children:[(0,s.jsx)("h3",{id:"upload-heading",className:"text-xl font-medium mb-4",children:"Upload image"}),(0,s.jsx)(d,{className:"h-80 sm:h-96 border-2 rounded-2xl overflow-hidden shadow-none",children:e?(0,s.jsxs)("div",{className:"relative w-full h-full",children:[(0,s.jsx)(y.default,{src:e,alt:"Uploaded food",fill:!0,sizes:"(max-width: 1024px) 100vw, 50vw",style:{objectFit:"cover"},priority:!0}),(0,s.jsx)("div",{className:"absolute bottom-4 right-4",children:(0,s.jsx)(m,{variant:"outline",className:"bg-white/80 backdrop-blur-sm text-gray-800 hover:bg-white",onClick:()=>a(null),size:"sm","aria-label":"Remove image",children:"Remove"})})]}):N?(0,s.jsxs)("div",{className:"relative w-full h-full bg-black",children:[(0,s.jsx)("video",{ref:C,autoPlay:!0,playsInline:!0,muted:!0,className:"h-full w-full object-cover","aria-label":"Camera preview"}),(0,s.jsx)("canvas",{ref:z,className:"hidden","aria-hidden":"true"}),(0,s.jsxs)("div",{className:"absolute bottom-4 inset-x-0 flex justify-center space-x-4",children:[(0,s.jsx)(m,{variant:"default",className:"rounded-full bg-white text-gray-800 hover:bg-gray-100",onClick:()=>{if(C.current&&z.current){let e=C.current,t=z.current;t.width=e.videoWidth,t.height=e.videoHeight;let s=t.getContext("2d");s&&(s.drawImage(e,0,0,t.width,t.height),a(t.toDataURL("image/jpeg",.9)),E(),l(null))}},"aria-label":"Take photo",children:"Capture Photo"}),(0,s.jsxs)(m,{variant:"outline",className:"rounded-full bg-white/80 backdrop-blur-sm text-gray-800 hover:bg-white",onClick:E,"aria-label":"Cancel camera",children:[(0,s.jsx)(h.A,{className:"h-4 w-4 mr-2","aria-hidden":"true"}),"Cancel"]})]})]}):(0,s.jsxs)(c,{className:"flex flex-col items-center justify-center p-6 h-full",children:[(0,s.jsx)("div",{className:"w-20 h-20 sm:w-24 sm:h-24 rounded-md bg-gray-100 flex items-center justify-center mb-6","aria-hidden":"true",children:(0,s.jsx)(g.A,{className:"h-10 w-10 sm:h-12 sm:w-12 text-gray-400"})}),(0,s.jsx)("p",{className:"text-lg sm:text-xl text-center mb-6",children:"Upload image"}),(0,s.jsx)(u,{ref:k,type:"file",accept:"image/jpeg, image/png, image/gif, image/webp",onChange:e=>{if(e.target.files&&e.target.files[0]){let t=e.target.files[0];if(!t.type.match(/^image\/(jpeg|png|gif|bmp|webp)$/i)){n("Please upload a valid image file (JPEG, PNG, GIF, BMP, or WebP).");return}if(t.size>0xa00000){n("Image too large. Please upload an image smaller than 10MB.");return}let s=new FileReader;s.onload=e=>{var t;(null===(t=e.target)||void 0===t?void 0:t.result)&&(a(e.target.result),l(null),n(null))},s.onerror=()=>{n("Error reading the image file. Please try another image.")},s.readAsDataURL(t)}},className:"hidden","aria-label":"Upload food image"}),(0,s.jsxs)("div",{className:"flex flex-col xs:flex-row space-y-3 xs:space-y-0 xs:space-x-4",children:[(0,s.jsxs)(m,{type:"button",variant:"outline",onClick:()=>{var e;null===(e=k.current)||void 0===e||e.click()},"aria-label":"Select image from files",children:[(0,s.jsx)(f.A,{className:"h-4 w-4 mr-2","aria-hidden":"true"}),"Choose file"]}),(0,s.jsxs)(m,{type:"button",variant:"outline",onClick:P,"aria-label":"Take photo with camera",children:[(0,s.jsx)(p.A,{className:"h-4 w-4 mr-2","aria-hidden":"true"}),"Take Photo"]})]})]})}),e&&(0,s.jsx)("div",{className:"mt-4 flex justify-center",children:(0,s.jsx)(m,{onClick:F,disabled:o,className:"mt-4",size:"lg","aria-label":o?"Analyzing image, please wait":"Analyze food image",children:o?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(b.A,{className:"h-4 w-4 mr-2 animate-spin","aria-hidden":"true"}),"Analyzing..."]}):"Analyze Food"})})]}),(0,s.jsxs)("section",{"aria-labelledby":"output-heading",children:[(0,s.jsx)("h3",{id:"output-heading",className:"text-xl font-medium mb-4",children:"Output"}),(0,s.jsx)(d,{className:"h-80 sm:h-96 rounded-2xl shadow-none border-2",children:(0,s.jsx)(c,{className:"p-6 sm:p-8 h-full",children:o?(0,s.jsxs)("div",{className:"flex flex-col items-center justify-center h-full space-y-4","aria-live":"polite","aria-busy":"true",children:[(0,s.jsx)(b.A,{className:"h-8 w-8 text-blue-500 animate-spin","aria-hidden":"true"}),(0,s.jsx)("p",{className:"text-gray-500 text-xl text-center",children:"Analyzing your food..."}),(0,s.jsx)("p",{className:"text-gray-400 text-sm text-center",children:"This may take a moment"})]}):i?(0,s.jsxs)("div",{className:"h-full flex flex-col items-center justify-center","aria-live":"assertive",children:[(0,s.jsx)(v.A,{className:"h-12 w-12 text-red-500 mb-4","aria-hidden":"true"}),(0,s.jsx)("p",{className:"text-gray-800 text-center",children:i})]}):t?(0,s.jsx)("div",{className:"h-full overflow-auto","aria-live":"polite",children:(0,s.jsx)("div",{className:"text-gray-800",dangerouslySetInnerHTML:{__html:t}})}):e?(0,s.jsx)("div",{className:"flex items-center justify-center h-full","aria-live":"polite",children:(0,s.jsxs)("div",{className:"flex flex-col items-center text-center",children:[(0,s.jsx)(j.A,{className:"h-8 w-8 text-blue-500 mb-4","aria-hidden":"true"}),(0,s.jsx)("p",{className:"text-gray-500 text-xl",children:'No analysis available. Click "Analyze Food" to begin.'})]})}):(0,s.jsx)("div",{className:"flex items-center justify-center h-full",children:(0,s.jsx)("span",{className:"text-gray-300 text-xl",children:"Generated text"})})})})]})]})]})})})}}},e=>{var a=a=>e(e.s=a);e.O(0,[63,552,441,684,358],()=>a(2693)),_N_E=e.O()}]);